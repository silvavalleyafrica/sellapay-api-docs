# Environment Variables Setup

## Overview

Environment variables allow you to store sensitive configuration (API keys, secrets) outside of your codebase. This prevents accidental exposure of credentials in version control.

## Standard Variables

Create a `.env` file in your project root with the following variables:

```env
# API Credentials (required)
SELLAPAY_API_KEY=your_api_key_here
SELLAPAY_API_SECRET=your_api_secret_here

# Base URL (optional, defaults to production)
SELLAPAY_BASE_URL=https://pay.sellapay.africa/api/v1

# Environment (development, staging, production)
APP_ENV=production

# Logging
LOG_LEVEL=info
LOG_FILE=logs/sellapay.log
```

## Language-Specific Loading

### Python

```python
import os
from dotenv import load_dotenv

load_dotenv()

api_key = os.getenv('SELLAPAY_API_KEY')
api_secret = os.getenv('SELLAPAY_API_SECRET')
```

### JavaScript (Node.js)

```javascript
require("dotenv").config();

const apiKey = process.env.SELLAPAY_API_KEY;
const apiSecret = process.env.SELLAPAY_API_SECRET;
```

### PHP

```php
require_once 'vendor/autoload.php';
$dotenv = Dotenv\Dotenv::createImmutable(__DIR__);
$dotenv->load();

$apiKey = getenv('SELLAPAY_API_KEY');
$apiSecret = getenv('SELLAPAY_API_SECRET');
```

### Ruby

```ruby
require 'dotenv'
Dotenv.load

api_key = ENV['SELLAPAY_API_KEY']
api_secret = ENV['SELLAPAY_API_SECRET']
```

## Production Deployment

### Docker

```dockerfile
FROM python:3.9
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

# Load environment from secrets
ENV SELLAPAY_API_KEY=${SELLAPAY_API_KEY}
ENV SELLAPAY_API_SECRET=${SELLAPAY_API_SECRET}

COPY . .
CMD ["python", "app.py"]
```

### Kubernetes

```yaml
apiVersion: v1
kind: Secret
metadata:
  name: sellapay-credentials
type: Opaque
data:
  api-key: <base64-encoded-key>
  api-secret: <base64-encoded-secret>
---
apiVersion: v1
kind: Pod
metadata:
  name: my-app
spec:
  containers:
    - name: app
      image: my-app:latest
      env:
        - name: SELLAPAY_API_KEY
          valueFrom:
            secretKeyRef:
              name: sellapay-credentials
              key: api-key
        - name: SELLAPAY_API_SECRET
          valueFrom:
            secretKeyRef:
              name: sellapay-credentials
              key: api-secret
```

### AWS Lambda

```python
import json
import boto3

ssm = boto3.client('ssm')

def lambda_handler(event, context):
    api_key = ssm.get_parameter(Name='SELLAPAY_API_KEY', WithDecryption=True)['Parameter']['Value']
    api_secret = ssm.get_parameter(Name='SELLAPAY_API_SECRET', WithDecryption=True)['Parameter']['Value']

    # Use credentials
    return {'statusCode': 200}
```

## Security Best Practices

1. **Never commit `.env` files**

   ```bash
   # .gitignore
   .env
   .env.local
   .env.*.local
   ```

2. **Use `.env.example`**

   ```env
   # .env.example (commit this, minus actual values)
   SELLAPAY_API_KEY=your_api_key_here
   SELLAPAY_API_SECRET=your_api_secret_here
   SELLAPAY_BASE_URL=https://pay.sellapay.africa/api/v1
   ```

3. **Rotate credentials regularly**
   - Monthly or quarterly
   - Immediately if compromised
   - Maintain old credentials during rotation period

4. **Use strong secret values**
   - Generated by Sellapay
   - 32+ characters
   - Mix of alphanumeric and special characters

5. **Restrict access**
   - Limit who can view environment variables
   - Use role-based access control (RBAC)
   - Audit access logs

## Validation

### Check Credentials

```bash
# Verify environment variables are set
echo $SELLAPAY_API_KEY
echo $SELLAPAY_API_SECRET

# Test authorization
curl -X POST \
  -H "X-API-KEY: $SELLAPAY_API_KEY" \
  -H "X-API-SECRET: $SELLAPAY_API_SECRET" \
  https://pay.sellapay.africa/api/v1/authorize
```

## Troubleshooting

| Problem                 | Cause                           | Solution                                                                        |
| ----------------------- | ------------------------------- | ------------------------------------------------------------------------------- |
| "Undefined variable"    | Environment variable not loaded | Ensure `load_dotenv()` or `require dotenv` is called before accessing variables |
| Wrong credentials error | Typo in variable name           | Check spelling: `SELLAPAY_API_KEY` (exact case)                                 |
| Empty string value      | Variable not set                | Verify `.env` file exists and is in correct directory                           |
